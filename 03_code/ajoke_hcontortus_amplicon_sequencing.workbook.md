# Amplicons sequencing workbook

- this is a workspace for Ajoke and Steve to interact and keep track of work undertaken to analyse amplicon sequencing data



## What we want to achieve
- Aim: to optimise the amplicon sequencing approach
- What are we working with: Amplicon sequencing data generated by Umer Chaudrhy
- What we want to discover:

1. How many worms have sequencing data?
    - How reads per worm?
    - Step1 - multiplex PCR per worm
    - Step2 - pool the PCR products from each worm into a single tube
        - RESULT - how good were the worms pooled? How much DNA was present
    - Q. do we need to measure the concentration of DNA to pool
    - Q. is there enough DNA to produce PCR products

2. Of the worms that have sequencing data, how many reads map to the genome
    - We “expected” that all the reads map to the genome. Do they?
        - Eg. could get primer dimers that produce sequencing reads, but don’t map
    - What proportion of all reads map?

3. Of the reads that map to the genome, what proportion of the reads map to where we expect them to map.
    - Primers have been designed to amplify specific regions
    - What proportion of reads map correctly to where we designed the primers?

4. Of the reads that map correctly, how many reads do we get per amplicon
    - We hope that all amplicons are present, but we dont know this
    - Are all amplicons present?
    - Are the present in equal proportions?
    - Have any clearly not worked, or worked too well?



---
### 1. How many worms have sequencing data?

```bash
# counting lines using word count or "wc"
wc -l *fastq
```
- this prints all the information, however, it still needs some interpretation. 
- how about we do something slightly more sophisticated. Just a little. Lets use a "for loop"

```bash
# basic loop, and we'll print the name
for NAME in *_1.fastq; do
    echo -e "${NAME}";
    done
```
- try this. It should print a list of the file names


- if this works, lets add some extra commands to calculate the number of reads
```bash
for NAME in *_1.fastq; do 
    # count the lines, and extract the 1st column using "awk" and divide it by 4
    READS=$( wc -l ${NAME} | awk '{print $1/4}' ) ;
    # print the name and read count
    echo -e "${NAME}\t${READS}" >> raw_reads.count ;     
    done 

# create new file
> new.file

# add to an existing file
>> new.file
```bash
# count the number of reads
for NAME in *1.fastq; do READS=$( wc -1)${NAME} | awk {print $1/4} ); echo -e "${NAME}\t${READS}" >> raw_reads.count; done
# fastqc
for NAME in *fastq; do fastqc $NAME; done
# multiqc
multiqc ..
firefox multiqc_report.html
Total number of reads for ALL18 Dataset = 3506725 with 76 samples. The total number of reads expected per 
